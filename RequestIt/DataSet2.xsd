<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="DataSet2" targetNamespace="http://tempuri.org/DataSet2.xsd" xmlns:mstns="http://tempuri.org/DataSet2.xsd" xmlns="http://tempuri.org/DataSet2.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:msprop="urn:schemas-microsoft-com:xml-msprop" attributeFormDefault="qualified" elementFormDefault="qualified">
  <xs:annotation>
    <xs:appinfo source="urn:schemas-microsoft-com:xml-msdatasource">
      <DataSource DefaultConnectionIndex="0" FunctionsComponentName="QueriesTableAdapter" Modifier="AutoLayout, AnsiClass, Class, Public" SchemaSerializationMode="IncludeSchema" xmlns="urn:schemas-microsoft-com:xml-msdatasource">
        <Connections>
          <Connection AppSettingsObjectName="Settings" AppSettingsPropertyName="RequestItConnectionString" ConnectionStringObject="" IsAppSettingsProperty="true" Modifier="Assembly" Name="RequestItConnectionString (Settings)" ParameterPrefix="@" PropertyReference="ApplicationSettings.RequestIt.Properties.Settings.GlobalReference.Default.RequestItConnectionString" Provider="System.Data.SqlClient" />
        </Connections>
        <Tables>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="DataTable1TableAdapter" GeneratorDataComponentClassName="DataTable1TableAdapter" Name="DataTable1" UserDataComponentName="DataTable1TableAdapter">
            <MainSource>
              <DbSource ConnectionRef="RequestItConnectionString (Settings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        QueryResult4.name AS ProductName, QueryResult3.TotalQtde AS Qtde, QueryResult3.TotalQtde * QueryResult4.costPrice AS TotalPrice
FROM            (SELECT        allIds, SUM(tQuantity) AS TotalQtde
                          FROM            (SELECT        ISNULL(cp.productId, ri.productId) AS allIds, ri.quantity * ISNULL(cp.quantity, 1) AS tQuantity
                                                    FROM            RequestsItems AS ri INNER JOIN
                                                                              Requests AS r ON r.id = ri.requestId INNER JOIN
                                                                              Products AS p ON p.id = ri.productId LEFT OUTER JOIN
                                                                              CompoundProducts AS cp ON cp.compoundProductId = ri.productId
                                                    WHERE        (r.requestDate BETWEEN CAST(@startDate AS Date) AND CAST(@endDate AS Date))) AS QueryResult1
                          GROUP BY allIds) AS QueryResult3 INNER JOIN
                             (SELECT        id, name, costPrice
                               FROM            Products
                               WHERE        (id IN
                                                             (SELECT DISTINCT allIds
                                                               FROM            (SELECT        ISNULL(cp.productId, ri.productId) AS allIds
                                                                                         FROM            RequestsItems AS ri INNER JOIN
                                                                                                                   Requests AS r ON r.id = ri.requestId INNER JOIN
                                                                                                                   Products AS p ON p.id = ri.productId LEFT OUTER JOIN
                                                                                                                   CompoundProducts AS cp ON cp.compoundProductId = ri.productId
                                                                                         WHERE        (r.requestDate BETWEEN CAST(@startDate AS Date) AND CAST(@endDate AS Date))) AS QueryResult2
                                                               GROUP BY allIds))) AS QueryResult4 ON QueryResult3.allIds = QueryResult4.id</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="startDate" ColumnName="requestDate " DataSourceName="" DataTypeServer="date" DbType="DateTime" Direction="Input" ParameterName="@startDate" Precision="0" ProviderType="DateTime" Scale="0" Size="3" SourceColumn="requestDate " SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="endDate" ColumnName="requestDate " DataSourceName="" DataTypeServer="date" DbType="DateTime" Direction="Input" ParameterName="@endDate" Precision="0" ProviderType="DateTime" Scale="0" Size="3" SourceColumn="requestDate " SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="ProductName" DataSetColumn="ProductName" />
              <Mapping SourceColumn="Qtde" DataSetColumn="Qtde" />
              <Mapping SourceColumn="TotalPrice" DataSetColumn="TotalPrice" />
            </Mappings>
            <Sources />
          </TableAdapter>
        </Tables>
        <Sources />
      </DataSource>
    </xs:appinfo>
  </xs:annotation>
  <xs:element name="DataSet2" msdata:IsDataSet="true" msdata:UseCurrentLocale="true" msprop:EnableTableAdapterManager="true" msprop:Generator_DataSetName="DataSet2" msprop:Generator_UserDSName="DataSet2">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element name="DataTable1" msprop:Generator_TableClassName="DataTable1DataTable" msprop:Generator_TableVarName="tableDataTable1" msprop:Generator_TablePropName="DataTable1" msprop:Generator_RowDeletingName="DataTable1RowDeleting" msprop:Generator_RowChangingName="DataTable1RowChanging" msprop:Generator_RowEvHandlerName="DataTable1RowChangeEventHandler" msprop:Generator_RowDeletedName="DataTable1RowDeleted" msprop:Generator_UserTableName="DataTable1" msprop:Generator_RowChangedName="DataTable1RowChanged" msprop:Generator_RowEvArgName="DataTable1RowChangeEvent" msprop:Generator_RowClassName="DataTable1Row">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ProductName" msprop:Generator_ColumnVarNameInTable="columnProductName" msprop:Generator_ColumnPropNameInRow="ProductName" msprop:Generator_ColumnPropNameInTable="ProductNameColumn" msprop:Generator_UserColumnName="ProductName">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="Qtde" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnQtde" msprop:Generator_ColumnPropNameInRow="Qtde" msprop:Generator_ColumnPropNameInTable="QtdeColumn" msprop:Generator_UserColumnName="Qtde" type="xs:int" minOccurs="0" />
              <xs:element name="TotalPrice" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTotalPrice" msprop:Generator_ColumnPropNameInRow="TotalPrice" msprop:Generator_ColumnPropNameInTable="TotalPriceColumn" msprop:Generator_UserColumnName="TotalPrice" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:choice>
    </xs:complexType>
  </xs:element>
</xs:schema>